# Worksheet 2: Using APIs {.unnumbered}

In this worksheet, we will be going through an example of using the Google Trends API.

Google Trends can---and has---been used in research to give us information on the broader context of a given phenomenon, or might even be used as the main core of empirical data (e.g., @brodeur2021covid).

In what follow, we will get to grips with what an API is, and use a particular R package called `gtrendsR` to query the Google Trends API.

The examples for this worksheet were adapted from @bauer2022apis.

We can start by looking at the bare bones of an API request. To do this, we will use the `httr2` package:

```{r, eval = T}
library(httr)

getreq <- GET("https://trends.google.com/trends/explore",
    query=list(q = "Covid",geo = "US"))
```

This returns a list containing some data as well as the various parameters that we sent to the Google Trends API. We can have a look at these as follows:

```{r, eval = T}
getreq[["url"]]
```

This shows the url that we sent to the API. And that is all an API request really is. Here, we're just specifying the place (US) and the keyword (Covid). Everything else is set to its default.

A more straightforward way of specifying different parameters in an API call is by using a pre-packaged library optimized for querying it.

Let's see what the same call would look like using `gtrendsR`:

```{r, eval = T}
library(gtrendsR)
data("countries") # get abbreviations of all countries to filter data 
data("categories") # get numbers of all categories to filter data 

gtrendsdat <- gtrends("Covid",geo=c("US"))
```

And then we could introduce different countries:

```{r, eval = T}
library(gtrendsR)
data("countries") # get abbreviations of all countries to filter data 
data("categories") # get numbers of all categories to filter data 

gtrendsdat <- gtrends("Covid",geo=c("US", "GB", "FR"))
```

## Questions

1.  Make your own request to the Google Trends API

2.  Plot the results

3.  Think of an event before and after which you think trends might have changed

4.  Collect trends for the outcome, plot, and add vertical line on the plot for when the event took place
