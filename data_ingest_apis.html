<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>data_ingest_apis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="data_ingest_apis_files/libs/clipboard/clipboard.min.js"></script>
<script src="data_ingest_apis_files/libs/quarto-html/quarto.js"></script>
<script src="data_ingest_apis_files/libs/quarto-html/popper.min.js"></script>
<script src="data_ingest_apis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="data_ingest_apis_files/libs/quarto-html/anchor.min.js"></script>
<link href="data_ingest_apis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="data_ingest_apis_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="data_ingest_apis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="data_ingest_apis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="data_ingest_apis_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="data_ingest_apis_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="data_ingest_apis_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="worksheet-2-importing-data-and-apis" class="level1 unnumbered">
<h1 class="unnumbered">Worksheet 2: Importing data and APIs</h1>
<section id="using-apis" class="level2">
<h2 class="anchored" data-anchor-id="using-apis">Using APIs</h2>
<p>To practice these skills, you might want to create a new account for your academic research. But you needn’t create a new account to follow the steps below. You can simply use your own account—if you have one—as using the developer tools will not change anything about your public Twitter account.</p>
<p><img src="data/twitterdev.png" class="img-fluid" style="width:100.0%"></p>
<p>Before proceeding, we’ll load the remaining packages we will need for this tutorial.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># loads dplyr, ggplot2, and others</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rtweet) <span class="co"># to query the Twitter API in R</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'rtweet' was built under R version 4.1.3</code></pre>
</div>
</div>
<p>Once you’ve create your new account, or have logged into your existing one, go to the Twitter developer portal log in page <a href="https://developer.twitter.com/en">here</a>.</p>
<p>Click on Apply in the navigation bar on the top right of the page. You’ll be asked “what best describes you?” For the purposes of this tutorial, select academic, and then select student. Fill in all the relevant information and submit your application. Your application will then be reviewed by Twitter before access is granted. This might take hours or days.</p>
<p>Once you have authorization, a new tab will appear in the navigation bar at the top of the develop portal, as below:</p>
<p><img src="data/twitterdev2.png" class="img-fluid" style="width:100.0%"></p>
<p>Navigate to the developer portal and you will there be able to create a new “app” to query the API. You see in my account that I have several apps for different purposes.</p>
<p><img src="data/twitterdev3.png" class="img-fluid" style="width:100.0%"> We can create a new app on this page too. When we click “Create App” we will first be asked to name the app. Most importantly, we will then be given an “API key”; an “API secret key”; and a “Bearer token” as below.</p>
<p><img src="data/twitterdev4.png" class="img-fluid" style="width:30.0%"></p>
<p>You <strong>MUST</strong> make a record of these. Once you have done so, you can then use these to access the API. Once you have recorded these, navigate to the App setting tabs for the App you’ve created now listed in the Overview tab on the left hand side navigation window.</p>
<p><img src="data/twitterdev5.png" class="img-fluid" style="width:50.0%"></p>
<p>Navigate to “Keys and tokens” on this page, and click generate in the Access token &amp; secret box as below:</p>
<p><img src="data/twitterdev6.png" class="img-fluid" style="width:50.0%"></p>
<p>Record these as well. Once you have all of these keys and tokens recorded somewhere safe, you are ready to collect data!</p>
<p>This is pretty simple using the <tt>rtweet</tt> package. Below, we’ll collect the last 50 tweets of the founder of Twitter: Jack Dorsey.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>api_key <span class="ot">&lt;-</span><span class="st">" XXXXXXXXXXXXXXXXXXXXXXX"</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>api_key_secret <span class="ot">&lt;-</span> <span class="st">"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>access_token <span class="ot">&lt;-</span> <span class="st">"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>access_token_secret <span class="ot">&lt;-</span> <span class="st">"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>token <span class="ot">&lt;-</span> <span class="fu">create_token</span>(</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">app =</span> <span class="st">"NAME YOUR APP"</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">consumer_key =</span> api_key,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">consumer_secret =</span> api_key_secret,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">access_token =</span> access_token,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">access_secret =</span> access_token_secret</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>user <span class="ot">&lt;-</span> <span class="st">"@jack"</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>jacktweets <span class="ot">&lt;-</span> <span class="fu">get_timeline</span>(user, <span class="at">n =</span> <span class="dv">50</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(jacktweets)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once you have enter your keys, tokens, and key/token secrets, store them with the <code>create_token()</code> function. Here, we are collecting the last 50 tweets for Jack Dorsey, though you can change this by specifying a higher n—be aware, though, that the maximum you are able to collect with the basic API access is 3200 tweets.</p>
<div class="cell">
<div class="cell-output-display">

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> created_at </th>
   <th style="text-align:left;"> screen_name </th>
   <th style="text-align:left;"> text </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 2021-02-25 23:36:34 </td>
   <td style="text-align:left;"> jack </td>
   <td style="text-align:left;"> Bitcoin, Blockchain and the Black Community - CoinDesk https://t.co/3KH6W7Rg0Q </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2021-02-25 23:32:42 </td>
   <td style="text-align:left;"> jack </td>
   <td style="text-align:left;"> Starting in less than an hour! 👇🏾

Tune into @CoinDesk TV and watch #CommunityCrypto at 5pm ET 

See you then! ✊🏾 https://t.co/ACnRhdabEy </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2021-02-25 04:22:10 </td>
   <td style="text-align:left;"> jack </td>
   <td style="text-align:left;"> Crypto art changing lives https://t.co/yDEQOaA483 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2021-02-25 03:59:05 </td>
   <td style="text-align:left;"> jack </td>
   <td style="text-align:left;"> https://t.co/2i46RZ6c0A </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2021-02-24 04:47:59 </td>
   <td style="text-align:left;"> jack </td>
   <td style="text-align:left;"> @hfangca @OKCoin @opencryptoorg Thank you for joining! </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2021-02-23 17:13:31 </td>
   <td style="text-align:left;"> jack </td>
   <td style="text-align:left;"> @bitcoinbrink 🙏🏼 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2021-02-20 02:06:24 </td>
   <td style="text-align:left;"> jack </td>
   <td style="text-align:left;"> It’s an honor to help in this important endeavor. All orgs developing in crypto — for-profit or nonprofit, even individuals — should consider joining. There is strength in numbers. https://t.co/CJo9frhkhJ </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2021-02-20 01:47:23 </td>
   <td style="text-align:left;"> jack </td>
   <td style="text-align:left;"> Over 6,600 people submitted their proof-of-work so far. Working to narrow over weekend and will start interviewing board candidates soon. </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2021-02-19 20:34:35 </td>
   <td style="text-align:left;"> jack </td>
   <td style="text-align:left;"> This is excellent 🧡 https://t.co/e7ywpoCcxS </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2021-02-17 03:47:40 </td>
   <td style="text-align:left;"> jack </td>
   <td style="text-align:left;"> learned the most from https://t.co/GrUoCXanNL and https://t.co/cz3yYo4UEw </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Now you can play around with the different API calls possible with the <tt>rtweet</tt> package. See the full documentation <a href="https://cran.r-project.org/web/packages/rtweet/rtweet.pdf">here</a> and <a href="https://github.com/ropensci/rtweet">here</a>.</p>
<p>And for those interested, you can my package to collect tweets from the Academic Research Product Track API <a href="https://github.com/cjbarrie/academictwitteR">here</a>.</p>
<p>Getting access to the Academic Research Product Track is a bit more complicated but for more information on how to apply see <a href="https://developer.twitter.com/en/solutions/academic-research/products-for-researchers">here</a>.</p>
<p>In order to use the Twitter Academic Research Product Track you will first need to obtain an authorization token. You will find details about the process of obtaining authorization <a href="https://developer.twitter.com/en/solutions/academic-research/application-info">here</a>.</p>
<p><strong>In order to gain authorization you first need a Twitter account.</strong></p>
<p>First, Twitter will ask for details about your academic profile. Per the documentation linked above, they will ask for the following:</p>
<blockquote class="blockquote">
<p>Your full name as it is appears on your institution’s documentation</p>
<p>Links to webpages that help establish your identity; provide one or more of the following:</p>
<ul>
<li>A link to your profile in your institution’s faculty or student directory</li>
<li>A link to your Google Scholar profile</li>
<li>A link to your research group, lab or departmental website where you are listed</li>
</ul>
<p>Information about your academic institution: its name, country, state, and city</p>
<p>Your department, school, or lab name</p>
<p>Your academic field of study or discipline at this institution</p>
<p>Your current role as an academic (whether you are a graduate student, doctoral candidate, post-doc, professor, research scientist, or other faculty member)</p>
</blockquote>
<p>Twitter will then ask for details of the proposed research project. Here, questions include:</p>
<blockquote class="blockquote">
<ol type="1">
<li><p>What is the name of your research project?</p></li>
<li><p>Does this project receive funding from outside your academic institution? If yes, please list all your sources of funding.</p></li>
<li><p>In English, describe your research project. Minimum 200 characters.</p></li>
<li><p>In English, describe how Twitter data via the Twitter API will be used in your research project. Minimum 200 characters.</p></li>
<li><p>In English, describe your methodology for analyzing Twitter data, Tweets, and/or Twitter users. Minimum 200 characters.</p></li>
<li><p>Will your research present Twitter data individually or in aggregate?</p></li>
<li><p>In English, describe how you will share the outcomes of your research (include tools, data, and/or other resources you hope to build and share). Minimum 200 characters.</p></li>
<li><p>Will your analysis make Twitter content or derived information available to a government entity?</p></li>
</ol>
</blockquote>
<p>Once you have gained authorization for your project you will be able to see the new project on your Twitter developer portal.</p>
<p>The Academic Research Product Track permits the user to access larger volumes of data, over a far longer time range, than was previously possible. From the Twitter <a href="https://developer.twitter.com/en/solutions/academic-research/application-info">documentation</a>:</p>
<blockquote class="blockquote">
<p>“The Academic Research product track includes full-archive search, as well as increased access and other v2 endpoints and functionality designed to get more precise and complete data for analyzing the public conversation, at no cost for qualifying researchers. Since the Academic Research track includes specialized, greater levels of access, it is reserved solely for non-commercial use”.</p>
</blockquote>
<p>The new “v2 endpoints” refer to the v2 API, introduced around the same time as the new Academic Research Product Track. Full details of the v2 endpoints are available <a href="https://developer.twitter.com/en/docs/twitter-api/early-access">here</a>.</p>
<p>In summary the Academic Research product track allows the authorized user:</p>
<ol type="1">
<li>Access to the full archive of (as-yet-undeleted) tweets published on Twitter</li>
<li>A higher monthly tweet cap (10m–or 20x what was previously possible with the standard v1.1 API)</li>
<li>Ability to access these data with more precise filters permitted by the v2 API</li>
</ol>
<p>If you do get authorization for using the Twitter Academic API, you can then follow the next steps to begin collecting data. Instead of four different keys or secrets, we will have one “bearer token” that we use, associated with one of the apps that we created as above. This is all we then need to begin collecting data.</p>
<p>First we need to load the package into memory as follows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(academictwitteR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The first task is set authorization credentials with the <code>set_bearer()</code> function, which allows the user to store their bearer token in the .Renviron file.</p>
<p>To do so, use:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set_bearer</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and enter authorization credentials as below:</p>
<p><img src="data/TWITTER_BEARER.gif" class="img-fluid"></p>
<p>This will mean that the bearer token is automatically called during API calls. It also avoids the inadvisable practice of hard-coding authorization credentials into scripts.</p>
<p>The workhorse function is <code>get_all_tweets()</code>, which is able to collect tweets matching a specific search query or all tweets by a specific set of users.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>tweets <span class="ot">&lt;-</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_all_tweets</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">query =</span> <span class="st">"#BlackLivesMatter"</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">start_tweets =</span> <span class="st">"2020-01-01T00:00:00Z"</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_tweets =</span> <span class="st">"2020-01-05T00:00:00Z"</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">file =</span> <span class="st">"blmtweets"</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_path =</span> <span class="st">"data/"</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="dv">1000000</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here, we are collecting tweets containing a hashtag related to the Black Lives Matter movement over the period January 1, 2020 to January 5, 2020.</p>
<p>We have also set an upper limit of one million tweets. When collecting large amounts of Twitter data we recommend including a <code>data_path</code> and setting <code>bind_tweets = FALSE</code> such that data is stored as JSON files and can be bound at a later stage upon completion of the API query.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>tweets <span class="ot">&lt;-</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_all_tweets</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">users =</span> <span class="fu">c</span>(<span class="st">"jack"</span>, <span class="st">"cbarrie"</span>),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">start_tweets =</span> <span class="st">"2020-01-01T00:00:00Z"</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_tweets =</span> <span class="st">"2020-01-05T00:00:00Z"</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">file =</span> <span class="st">"blmtweets"</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="dv">1000</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Whereas here we are not specifying a search query and instead are requesting all tweets by users “jack” and “cbarrie” over the period January 1, 2020 to January 5, 2020. Here, we set an upper limit of 1000 tweets.</p>
<p>The search query and user query arguments can be combined in a single API call as so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_all_tweets</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">query =</span> <span class="st">"twitter"</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">users =</span> <span class="fu">c</span>(<span class="st">"cbarrie"</span>, <span class="st">"jack"</span>),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">start_tweets =</span> <span class="st">"2020-01-01T00:00:00Z"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">end_tweets =</span> <span class="st">"2020-05-01T00:00:00Z"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">1000</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Where here we would be collecting tweets by users “jack” and “cbarrrie” over the period January 1, 2020 to January 5, 2020 containing the word “twitter.”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_all_tweets</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">query =</span> <span class="fu">c</span>(<span class="st">"twitter"</span>, <span class="st">"social"</span>),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">users =</span> <span class="fu">c</span>(<span class="st">"cbarrie"</span>, <span class="st">"jack"</span>),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">start_tweets =</span> <span class="st">"2020-01-01T00:00:00Z"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">end_tweets =</span> <span class="st">"2020-05-01T00:00:00Z"</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">1000</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>While here we are collecting tweets by users “jack” and “cbarrrie” over the period January 1, 2020 to January 5, 2020 containing the words “twitter” or “social.”</p>
<p>Note that the “AND” operator is implicit when specifying more than one character string in the query. See <a href="https://developer.twitter.com/en/docs/twitter-api/tweets/search/integrate/build-a-query">here</a> for information on building queries for search tweets. Thus, when searching for all elements of a character string, a call may look like:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_all_tweets</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">query =</span> <span class="fu">c</span>(<span class="st">"twitter social"</span>),</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">users =</span> <span class="fu">c</span>(<span class="st">"cbarrie"</span>, <span class="st">"jack"</span>),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">start_tweets =</span> <span class="st">"2020-01-01T00:00:00Z"</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">end_tweets =</span> <span class="st">"2020-05-01T00:00:00Z"</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">1000</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>, which will capture tweets containing <em>both</em> the words “twitter” and “social.” The same logics apply for hashtag queries.</p>
<p>Whereas if we specify our query as separate elements of a character vector like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_all_tweets</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">query =</span> <span class="fu">c</span>(<span class="st">"twitter"</span>, <span class="st">"social"</span>),</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">users =</span> <span class="fu">c</span>(<span class="st">"cbarrie"</span>, <span class="st">"jack"</span>),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">start_tweets =</span> <span class="st">"2020-01-01T00:00:00Z"</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">end_tweets =</span> <span class="st">"2020-05-01T00:00:00Z"</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">1000</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>, this will be capturing tweets by users “cbarrie” or “jack” containing the words “twitter” <em>or</em> social.</p>
<p>Finally, we may wish to query an exact phrase. To do so, we can either input the phrase in escape quotes, e.g., <code>query ="\"Black Lives Matter\""</code> or we can use the optional parameter <code>exact_phrase = T</code> to search for tweets containing the exact phrase string:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>tweets <span class="ot">&lt;-</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_all_tweets</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">query =</span> <span class="st">"#BlackLivesMatter"</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">start_tweets =</span> <span class="st">"2020-01-01T00:00:00Z"</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_tweets =</span> <span class="st">"2020-01-05T00:00:00Z"</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">file =</span> <span class="st">"blmtweets"</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_path =</span> <span class="st">"data/"</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="dv">1000000</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here, we are collecting tweets containing a hashtag related to the Black Lives Matter movement over the period January 1, 2020 to January 5, 2020.</p>
<p>And the Twitter API is, of course, not the only API out there!</p>
<section id="other-apis-r-packages" class="level3">
<h3 class="anchored" data-anchor-id="other-apis-r-packages">Other APIs (R packages)</h3>
<ul>
<li><a href="https://cran.r-project.org/web/packages/manifestoR/index.html">https://cran.r-project.org/web/packages/manifestoR/index.html</a></li>
<li><a href="https://cran.r-project.org/web/packages/vkR/vkR.pdf">https://cran.r-project.org/web/packages/vkR/vkR.pdf</a></li>
<li><a href="https://cran.r-project.org/web/packages/tuber/index.html">https://cran.r-project.org/web/packages/tuber/index.html</a></li>
</ul>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>